(function() {

  var app = angular.module('recruitmentApp', []);

  app.controller('contractorDashController', ["$scope", "$http", function($scope, $http) {

    $scope.contractor = [];

    $http.get('/dashboard/get_current_user.json').success(function(data){
      $scope.contractor = data


      $scope.options = [{ name: "unlimited", id:"unlimited" }, { name: "500 miles", id:"500 miles" }, { name: "200 miles", id:"200 miles" }, { name: "100 miles", id:"100 miles" }, { name: "50 miles", id:"50 miles" }, { name: "20 miles", id:"20 miles" }];
      
     for(var i = 0; i < $scope.options.length; i++) { 
        if ($scope.options[i].name ==  $scope.contractor.distance_travel){
            $scope.selectedOption = $scope.options[i]
        }
      }
    })

    $scope.available = function() {

      $http.put('dashboard/update_available_now.json', { id: $scope.contractor.id }).success(function (data){
        if ($scope.contractor.available_now)
           $scope.contractor.available_now = false
        else
           $scope.contractor.available_now = true
      }) 
    }
    $scope.update = function() {
       
        $http.put('dashboard/update_distance_travel.json', { id: $scope.contractor.id, distance_travel: $scope.selectedOption.name }).success(function (data){
        alert("it might have updated?  refresh! ")
      })
    }


  }])

})();